language: node_js
node_js:
  - "14"
dist: trusty

addons:
  chrome: stable

cache:
  directories:
      - ./node_modules

sudo: required
branches:
  only:
  - master

install:
  - npm install

before_script:
  - npm install -g @angular/cli

jobs:
  include:
    - stage: check
      name: Check Validity
      script: 
        - ng lint
        - ng build --prod --base-href https://see.pete.run/
        - npm run test-headless
    - stage: production
      name: Deploy To Production
      script:
        - ng build --prod --base-href https://see.pete.run/
      deploy:
        provider: firebase
        skip_cleanup: true
        token:
          secure: "fP3b5NFgzGlgP3sPF4/N5KEze9R0zuWklJK/IB72W+cVIjqn1Ax2LahVrvYXjwThCvc8KmcAyA73DEaUR638yNueSJAko4slx4VPF9RVwKJ4sBCgVXSu/nYcCVLSLT5MFJCci4XDv9LEHsQ1XEuR4/mahP+sp9l9SpYmmQE7mj9+2GMpbvV3pzWeuLY397kUBJ4FtomhbHgVe981UF5ofOFAQyV5WvNBsbNT5uMFj7S83RhEI268w/7UY2p3eb+sbwwVbN9/ziXc/KOJ2EO+gpHH6nGj7cCSmw4Qq8cdyYCuEDPtpq7dDJpvp2jP76i9wygRFjM0UgS0rBPfEerO0KNRFLOheGC5laH7Qf2XvWc+B+vVh0x60NYCuZb7omh0SFvYYdrG1hxTsvpyerSmkdnlI68gSh9ApIMmbeFmOjEOrLzdHffM4XaxQ8Jh4NpGGC2v/jnAeAH2Go5lRVLD2SF6BpAxGxvA3w2xULh0T0npVGWPs3r83UeehTBK6jC0pJy43HcG77nP4rJNBHnuklOwu8O5BK8UxJtjlakJK7IFVu5sDpK4V3ke6c/zllbTJ82hCCa78BzLTM+jic3uL+b292PmfUy4i9Dc3wGAfl2gwJBQ4/5XiX0MVWCxTzYJkWenQDwu57d4B/gRBBg94lg7czXy8Ckq4vRVBSRAbu8="
        project: see-pete-run